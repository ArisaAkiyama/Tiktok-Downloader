<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikDown</title>
    <link rel="stylesheet" href="popup.css">
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <img src="../icons/tiktok-logo.png" width="28" height="28" alt="TikTok">
                <span>TikDown</span>
            </div>
            <button id="settingsBtn" class="settings-btn" title="Settings">
                <svg viewBox="0 0 512 512" width="20" height="20">
                    <defs>
                        <linearGradient id="gearGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#25F4EE" />
                            <stop offset="100%" style="stop-color:#FE2C55" />
                        </linearGradient>
                    </defs>
                    <path fill="none" stroke="url(#gearGradient)" stroke-width="32" stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M262.29 192.31a64 64 0 1 0 57.4 57.4 64.13 64.13 0 0 0-57.4-57.4zM416.39 256a154.34 154.34 0 0 1-1.53 20.79l45.21 35.46a10.81 10.81 0 0 1 2.45 13.75l-42.77 74a10.81 10.81 0 0 1-13.14 4.59l-44.9-18.08a16.11 16.11 0 0 0-15.17 1.75A164.48 164.48 0 0 1 325 400.8a15.94 15.94 0 0 0-8.82 12.14l-6.73 47.89a11.08 11.08 0 0 1-10.68 9.17h-85.54a11.11 11.11 0 0 1-10.69-8.87l-6.72-47.82a16.07 16.07 0 0 0-9-12.22 155.3 155.3 0 0 1-21.46-12.57 16 16 0 0 0-15.11-1.71l-44.89 18.07a10.81 10.81 0 0 1-13.14-4.58l-42.77-74a10.8 10.8 0 0 1 2.45-13.75l38.21-30a16.05 16.05 0 0 0 6-14.08c-.36-4.17-.58-8.33-.58-12.5s.21-8.27.58-12.35a16 16 0 0 0-6.07-13.94l-38.19-30A10.81 10.81 0 0 1 49.48 186l42.77-74a10.81 10.81 0 0 1 13.14-4.59l44.9 18.08a16.11 16.11 0 0 0 15.17-1.75A164.48 164.48 0 0 1 187 111.2a15.94 15.94 0 0 0 8.82-12.14l6.73-47.89A11.08 11.08 0 0 1 213.23 42h85.54a11.11 11.11 0 0 1 10.69 8.87l6.72 47.82a16.07 16.07 0 0 0 9 12.22 155.3 155.3 0 0 1 21.46 12.57 16 16 0 0 0 15.11 1.71l44.89-18.07a10.81 10.81 0 0 1 13.14 4.58l42.77 74a10.8 10.8 0 0 1-2.45 13.75l-38.21 30a16.05 16.05 0 0 0-6.05 14.08c.33 4.14.55 8.3.55 12.47z" />
                </svg>
            </button>
        </header>

        <!-- URL Input Section - Always Visible -->
        <div id="inputSection" class="section">
            <div id="autoDetectBadge" class="auto-detect-badge hidden">
                Auto-detected from current page
            </div>
            <div class="input-wrapper">
                <input type="url" id="urlInput" placeholder="Paste link video TikTok..." autocomplete="off">
                <button id="pasteBtn" class="paste-btn" title="Paste">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                    </svg>
                </button>
            </div>
            <button id="downloadBtn" class="download-btn">
                <span>Download</span>
                <svg viewBox="0 0 24 24" fill="none" width="18" height="18">
                    <path d="M12 3V16M12 16L7 11M12 16L17 11" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" />
                    <path d="M3 20H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                </svg>
            </button>
        </div>

        <!-- Loading State with Progress Bar -->
        <div id="loadingState" class="loading-state hidden">
            <div class="progress-container">
                <div class="progress-header">
                    <span id="progressStatus">Memproses...</span>
                    <span id="progressPercent">0%</span>
                </div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <p id="progressDetail" class="progress-detail">Menghubungkan ke server...</p>
            </div>
        </div>

        <!-- Error State -->
        <div id="errorState" class="error-state hidden">
            <div class="error-icon">Error</div>
            <p id="errorMessage">Error</p>
            <button id="retryBtn" class="retry-btn">Coba Lagi</button>
        </div>

        <!-- Results - Shown below input -->
        <div id="resultsSection" class="results-section hidden">
            <div class="results-header">
                <span id="mediaCount">0 media</span>
                <button id="downloadAllBtn" class="download-all-btn" title="Download semua foto/video">
                    Download Semua
                </button>
            </div>
            <div id="mediaList" class="media-list"></div>

            <!-- Video Info -->
            <div id="videoInfo" class="video-info hidden">
                <div class="info-row">
                    <span class="info-label">User:</span>
                    <span id="infoUsername" class="info-value">-</span>
                </div>
                <div id="captionRow" class="info-row caption-row hidden">
                    <span class="info-label">Caption:</span>
                    <span id="infoCaption" class="info-value caption">-</span>
                </div>
                <div id="statsRow" class="info-row stats-row hidden">
                    <span class="stat">Likes: <span id="statLikes">0</span></span>
                    <span class="stat">Comments: <span id="statComments">0</span></span>
                    <span class="stat">Shares: <span id="statShares">0</span></span>
                </div>
            </div>
        </div>

        <!-- Toast -->
        <div id="toast" class="toast hidden">
            <span id="toastMessage"></span>
        </div>

        <!-- Thumbnail Preview Popup -->
        <div id="previewPopup" class="preview-popup hidden">
            <img id="previewImage" src="" alt="Preview">
            <div id="previewInfo" class="preview-info"></div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>Made by ArisaAkiyama</p>
        </footer>
    </div>

    <script src="popup.js"></script>
</body>

</html>